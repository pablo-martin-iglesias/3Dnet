<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Matching</title>
</head>
<body>
    <h1>Manual Matching</h1>

    <!-- Formulario de Filtros -->
    <h2>Filters</h2>
    <form method="GET" action="/manual-match">
    <label for="community">Filter by Community:</label>
    <select id="community" name="community" onchange="updateProvinces()">
        <option value="" selected>All Communities</option>
        <option value="Andalusia">Andalusia</option>
        <option value="Aragon">Aragon</option>
        <option value="Asturias">Asturias</option>
        <option value="Islas Baleares">Islas Baleares</option>
        <option value="Canarias">Canarias</option>
        <option value="Cantabria">Cantabria</option>
        <option value="Castilla-La Mancha">Castilla-La Mancha</option>
        <option value="Castilla y León">Castilla y León</option>
        <option value="Cataluña">Cataluña</option>
        <option value="Extremadura">Extremadura</option>
        <option value="Galicia">Galicia</option>
        <option value="Madrid">Madrid</option>
        <option value="Murcia">Murcia</option>
        <option value="Navarra">Navarra</option>
        <option value="País Vasco">País Vasco</option>
        <option value="La Rioja">La Rioja</option>
        <option value="Comunidad Valenciana">Comunidad Valenciana</option>
        <option value="Ceuta">Ceuta</option>
        <option value="Melilla">Melilla</option>
    </select>

    <label for="province">Filter by Province:</label>
    <select id="province" name="province">
        <option value="" selected>All Provinces</option>
    </select>

    <label for="material">Filter by Material:</label>
    <select id="material" name="material">
        <option value="" selected>All Materials</option>
        <option value="PLA">PLA</option>
        <option value="ABS">ABS</option>
        <option value="PETG">PETG</option>
        <option value="Other">Other</option>
    </select>

    <button type="submit">Apply Filters</button>
    </form>


    <!-- Tabla de Client-Printer Matching -->
    <h2>Client-Printer Matching</h2>
    <table border="1">
        <tr>
            <th>Client ID</th>
            <th>Client Requirements</th>
            <th>Client Budget</th>
            <th>Printer ID</th>
            <th>Printer Characteristics</th>
            <th>Printer Materials</th>
            <th>Action</th>
        </tr>
        {% for client in clients %}
        <tr>
            <td>{{ client[0] }}</td>
            <td>{{ client[2] }}</td>
            <td>${{ client[3] }}</td>
            <td colspan="3">Select a Printer</td>
            <td>
                <form action="/manual-match" method="POST">
                    <input type="hidden" name="client_id" value="{{ client[0] }}">
                    <select name="printer_id" required>
                        {% for printer in printers %}
                        <option value="{{ printer[0] }}">
                            {{ printer[2] }} ({{ printer[3] }})
                        </option>
                        {% endfor %}
                    </select>
                    <button type="submit">Match</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <a href="/admin-dashboard">Back to Admin Dashboard</a>

    <script>
        const provinces = {
            "Andalusia": ["Almería", "Cádiz", "Córdoba", "Granada", "Huelva", "Jaén", "Málaga", "Sevilla"],
            "Aragon": ["Huesca", "Teruel", "Zaragoza"],
            "Asturias": ["Asturias"],
            "Islas Baleares": ["Mallorca", "Menorca", "Ibiza", "Formentera"],
            "Canarias": ["Tenerife", "La Gomera", "La Palma", "El Hierro", "Gran Canaria", "Fuerteventura", "Lanzarote"],
            "Cantabria": ["Cantabria"],
            "Castilla-La Mancha": ["Albacete", "Ciudad Real", "Cuenca", "Guadalajara", "Toledo"],
            "Castilla y León": ["Ávila", "Burgos", "León", "Palencia", "Salamanca", "Segovia", "Soria", "Valladolid", "Zamora"],
            "Cataluña": ["Barcelona", "Girona", "Lleida", "Tarragona"],
            "Extremadura": ["Badajoz", "Cáceres"],
            "Galicia": ["A Coruña", "Lugo", "Ourense", "Pontevedra"],
            "Madrid": ["Madrid"],
            "Murcia": ["Murcia"],
            "Navarra": ["Navarra"],
            "País Vasco": ["Álava", "Guipúzcoa", "Vizcaya"],
            "La Rioja": ["La Rioja"],
            "Comunidad Valenciana": ["Alicante", "Castellón", "Valencia"],
            "Ceuta": ["Ceuta"],
            "Melilla": ["Melilla"]
        };

        function updateProvinces() {
            const communitySelect = document.getElementById('community');
            const provinceSelect = document.getElementById('province');
            const selectedCommunity = communitySelect.value;

            // Limpiar opciones anteriores
            provinceSelect.innerHTML = '<option value="" selected>All Provinces</option>';

            // Agregar las nuevas opciones
            if (provinces[selectedCommunity]) {
                provinces[selectedCommunity].forEach(province => {
                    const option = document.createElement('option');
                    option.value = province;
                    option.textContent = province;
                    provinceSelect.appendChild(option);
                });
            }
        }
    </script>
</body>
</html>
